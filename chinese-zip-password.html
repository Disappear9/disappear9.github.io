<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>难绷的Zip与中文密码 - ThinkAlone</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#4f7489"><meta name="application-name" content="ThinkAlone"><meta name="msapplication-TileImage" content="/favicon.png"><meta name="msapplication-TileColor" content="#4f7489"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ThinkAlone"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="起因某天，我的朋友在QQ上转发给我了一个带密码的Zip压缩包 我看了一眼，双击后默认用WinRAR打开了，然后复制粘贴密码： 啊？密码错误？"><meta property="og:type" content="blog"><meta property="og:title" content="难绷的Zip与中文密码"><meta property="og:url" content="https://thinkalone.win/chinese-zip-password.html"><meta property="og:site_name" content="ThinkAlone"><meta property="og:description" content="起因某天，我的朋友在QQ上转发给我了一个带密码的Zip压缩包 我看了一眼，双击后默认用WinRAR打开了，然后复制粘贴密码： 啊？密码错误？"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/1.png"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/2.png"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/3.jpg"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/4.jpg"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/5.jpg"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/6.png"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/7.png"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/8.png"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/9.png"><meta property="og:image" content="https://thinkalone.win/pictures/chinese-zip-password/10.png"><meta property="article:published_time" content="2024-03-01T04:00:00.000Z"><meta property="article:modified_time" content="2024-03-01T04:00:00.000Z"><meta property="article:author" content="Disappear9"><meta property="article:tag" content="折腾那些事"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://thinkalone.win/pictures/chinese-zip-password/1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://thinkalone.win/chinese-zip-password.html"},"headline":"难绷的Zip与中文密码","image":["https://thinkalone.win/pictures/chinese-zip-password/1.png","https://thinkalone.win/pictures/chinese-zip-password/2.png","https://thinkalone.win/pictures/chinese-zip-password/3.jpg","https://thinkalone.win/pictures/chinese-zip-password/4.jpg","https://thinkalone.win/pictures/chinese-zip-password/5.jpg","https://thinkalone.win/pictures/chinese-zip-password/6.png","https://thinkalone.win/pictures/chinese-zip-password/7.png","https://thinkalone.win/pictures/chinese-zip-password/8.png","https://thinkalone.win/pictures/chinese-zip-password/9.png","https://thinkalone.win/pictures/chinese-zip-password/10.png"],"datePublished":"2024-03-01T04:00:00.000Z","dateModified":"2024-03-01T04:00:00.000Z","author":{"@type":"Person","name":"Disappear9"},"publisher":{"@type":"Organization","name":"ThinkAlone","logo":{"@type":"ImageObject","url":"https://thinkalone.win/logo.png"}},"description":"起因某天，我的朋友在QQ上转发给我了一个带密码的Zip压缩包 我看了一眼，双击后默认用WinRAR打开了，然后复制粘贴密码： 啊？密码错误？"}</script><link rel="canonical" href="https://thinkalone.win/chinese-zip-password.html"><link rel="alternate" href="/atom.xml" title="ThinkAlone" type="application/atom+xml"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/monokai.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-114968614-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-114968614-1');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/logo.png" alt="ThinkAlone" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="博客源码" href="https://github.com/Disappear9/disappear9.github.io"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-03-01T04:00:00.000Z" title="3/1/2024, 4:00:00 AM">2024-03-01</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%98%E8%85%BE%E9%82%A3%E4%BA%9B%E4%BA%8B/">折腾那些事</a></span><span class="level-item">9 分钟读完 (大约1297个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">难绷的Zip与中文密码</h1><div class="content"><h3 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h3><p><strong>某天，我的朋友在QQ上转发给我了一个带密码的Zip压缩包</strong><br><img src="/pictures/chinese-zip-password/1.png"></p>
<p>我看了一眼，双击后默认用WinRAR打开了，然后复制粘贴密码：<br><img src="/pictures/chinese-zip-password/2.png"></p>
<p>啊？密码错误？</p>
<hr>
<span id="more"></span> 
<p>我第一反应当然是怀疑是不是对面冲多了手滑，在输密码的时候不小心多打了点什么进去，但是经过我们10分钟的友好交流后，他确定以及肯定自己绝对没有手滑，还把传给我的压缩包重新下载下来 <strong>在手机上</strong> 把密码粘贴进去成功解压了。</p>
<p>我当时眉头一紧，立马感觉到自己似乎站到了坑的边缘。</p>
<h3 id="试图复现："><a href="#试图复现：" class="headerlink" title="试图复现："></a>试图复现：</h3><p>这里以我常用的文件管理器MiXplorer为例：<br>新建一个Zip压缩包，密码这里MiXplorer正常情况下只允许输入英文+数字，但我们可以直接把中文密码粘贴进去：<br><img src="/pictures/chinese-zip-password/3.jpg"></p>
<p>然后在手机上测试解压：<br><img src="/pictures/chinese-zip-password/4.jpg"><br><img src="/pictures/chinese-zip-password/5.jpg"><br>显然，是可以正常解压的，然后我们把这个压缩包传到电脑上(Win10)再次进行尝试：<br><img src="/pictures/chinese-zip-password/6.png"><br><img src="/pictures/chinese-zip-password/7.png">  </p>
<h3 id="原因分析："><a href="#原因分析：" class="headerlink" title="原因分析："></a>原因分析：</h3><p>不用多想，一定是编码的问题，但我很好奇，为什么会这样？以及原来的密码究竟被编码成了什么？</p>
<p>首先，我们Google搜索<code>java zip 中文密码</code>，通过查找可以得知一个包：<a target="_blank" rel="noopener" href="https://github.com/srikanth-lingala/zip4j">zip4j</a><br>然后我们写一小段代码来试着解压它：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.lingala.zip4j.ZipFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnZip</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;测试&quot;</span>;</span><br><span class="line">		<span class="type">ZipFile</span> <span class="variable">zipFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ZipFile</span>(<span class="string">&quot;D:\\Work\\Temp\\chinese-zip-password\\27.zip&quot;</span>);</span><br><span class="line">		zipFile.setPassword(password.toCharArray());</span><br><span class="line">		zipFile.extractAll(<span class="string">&quot;D:\\Work\\Temp\\chinese-zip-password\\d&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行，直接报错：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; net.lingala.zip4j.exception.ZipException: Wrong password!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>搜索得知安卓默认中文编码是UTF-8，然后在翻阅zip4j的文档，可以发现这样一个方法：<a target="_blank" rel="noopener" href="https://javadoc.io/static/net.lingala.zip4j/zip4j/2.11.5/net/lingala/zip4j/ZipFile.html#setUseUtf8CharsetForPasswords(boolean)">setUseUtf8CharsetForPasswords</a> 我们修改代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.lingala.zip4j.ZipFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnZip</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;测试&quot;</span>;</span><br><span class="line">		<span class="type">ZipFile</span> <span class="variable">zipFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ZipFile</span>(<span class="string">&quot;D:\\Work\\Temp\\chinese-zip-password\\27.zip&quot;</span>);</span><br><span class="line">		zipFile.setUseUtf8CharsetForPasswords(<span class="literal">false</span>);</span><br><span class="line">		zipFile.setPassword(password.toCharArray());</span><br><span class="line">		zipFile.extractAll(<span class="string">&quot;D:\\Work\\Temp\\chinese-zip-password\\d&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这次能成功运行了。<br>运行是成了，但是为什么？通过方法名搜索我们找到了这样一个issue：<a target="_blank" rel="noopener" href="https://github.com/srikanth-lingala/zip4j/issues/328">https://github.com/srikanth-lingala/zip4j/issues/328</a>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Using non-ascii characters for passwords is in a grey zone as far as zip specification is concerned. Some tools convert passwords to utf8 and some don&#x27;t. With the change that you linked, zip4j converts the password to utf8 by default, and I guess Windows doesn&#x27;t, and that&#x27;s why it works fine in your case when you revert the utf8 conversion.</span><br><span class="line"></span><br><span class="line">I added an option to ZipFile api to use utf8 or not for password encoding and decoding. If you are sure that your zip file will only be used on windows, you can now generated the zip files by not using utf8. You can set this flag via ZipFile.setUseUtf8CharsetForPasswords(boolean).</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>意思大概是zip4j在遇到中文密码的时候会先把密码转UTF-8，但是windows不会。这解决了我第一个疑问，下面我们来研究第二个问题：原来的密码究竟被编码成了什么？  </p>
<h3 id="密码便乘变成什么样了？"><a href="#密码便乘变成什么样了？" class="headerlink" title="密码便乘变成什么样了？"></a>密码<del>便乘</del>变成什么样了？</h3><p>我们直接翻阅zip4j的源代码：  </p>
<figure class="highlight java"><figcaption><span>src&#x2F;main&#x2F;java&#x2F;net&#x2F;lingala&#x2F;zip4j&#x2F;ZipFile.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUseUtf8CharsetForPasswords</span><span class="params">(<span class="type">boolean</span> useUtf8CharsetForPasswords)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.useUtf8CharsetForPasswords = useUtf8CharsetForPasswords;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>继续跟：  </p>
<figure class="highlight java"><figcaption><span>src&#x2F;main&#x2F;java&#x2F;net&#x2F;lingala&#x2F;zip4j&#x2F;crypto&#x2F;StandardDecrypter.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(<span class="type">byte</span>[] headerBytes, <span class="type">char</span>[] password, <span class="type">long</span> lastModifiedFileTime, <span class="type">long</span> crc,</span></span><br><span class="line"><span class="params">                    <span class="type">boolean</span> useUtf8ForPassword)</span> <span class="keyword">throws</span> ZipException &#123;</span><br><span class="line">    <span class="keyword">if</span> (password == <span class="literal">null</span> || password.length &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ZipException</span>(<span class="string">&quot;Wrong password!&quot;</span>, ZipException.Type.WRONG_PASSWORD);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    zipCryptoEngine.initKeys(password, useUtf8ForPassword);</span><br></pre></td></tr></table></figure>

<p>继续：  </p>
<figure class="highlight java"><figcaption><span>src&#x2F;main&#x2F;java&#x2F;net&#x2F;lingala&#x2F;zip4j&#x2F;crypto&#x2F;engine&#x2F;ZipCryptoEngine.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initKeys</span><span class="params">(<span class="type">char</span>[] password, <span class="type">boolean</span> useUtf8ForPassword)</span> &#123;</span><br><span class="line">  keys[<span class="number">0</span>] = <span class="number">305419896</span>;</span><br><span class="line">  keys[<span class="number">1</span>] = <span class="number">591751049</span>;</span><br><span class="line">  keys[<span class="number">2</span>] = <span class="number">878082192</span>;</span><br><span class="line">  <span class="type">byte</span>[] bytes = convertCharArrayToByteArray(password, useUtf8ForPassword);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">byte</span> b : bytes) &#123;</span><br><span class="line">    updateKeys((<span class="type">byte</span>) (b &amp; <span class="number">0xff</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>来了：  </p>
<figure class="highlight java"><figcaption><span>src&#x2F;main&#x2F;java&#x2F;net&#x2F;lingala&#x2F;zip4j&#x2F;util&#x2F;Zip4jUtil.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] convertCharArrayToByteArray(<span class="type">char</span>[] charArray, <span class="type">boolean</span> useUtf8Charset) &#123;</span><br><span class="line">  <span class="keyword">return</span> useUtf8Charset</span><br><span class="line">          ? convertCharArrayToByteArrayUsingUtf8(charArray)</span><br><span class="line">          : convertCharArrayToByteArrayUsingDefaultCharset(charArray);</span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] convertCharArrayToByteArrayUsingDefaultCharset(<span class="type">char</span>[] charArray) &#123;</span><br><span class="line">  <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[charArray.length];</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; charArray.length; i++) &#123;</span><br><span class="line">    bytes[i] = (<span class="type">byte</span>) charArray[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> bytes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们把这段代码复制下来，然后再找一段将输出转为HEX的代码，组合起来试着运行看看：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnZip</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;克拉拉&quot;</span>;</span><br><span class="line"></span><br><span class="line">		System.out.println(password.toCharArray());</span><br><span class="line"></span><br><span class="line">		<span class="type">byte</span>[] encbytes = <span class="keyword">new</span> <span class="title class_">byte</span>[password.toCharArray().length];</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; password.toCharArray().length; i++) &#123;</span><br><span class="line">			encbytes[i] = (<span class="type">byte</span>) password.toCharArray()[i];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(bytesToHex(encbytes));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span>[] HEX_ARRAY = <span class="string">&quot;0123456789ABCDEF&quot;</span>.toCharArray();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">bytesToHex</span><span class="params">(<span class="type">byte</span>[] bytes)</span> &#123;</span><br><span class="line">	    <span class="type">char</span>[] hexChars = <span class="keyword">new</span> <span class="title class_">char</span>[bytes.length * <span class="number">2</span>];</span><br><span class="line">	    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; bytes.length; j++) &#123;</span><br><span class="line">	        <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> bytes[j] &amp; <span class="number">0xFF</span>;</span><br><span class="line">	        hexChars[j * <span class="number">2</span>] = HEX_ARRAY[v &gt;&gt;&gt; <span class="number">4</span>];</span><br><span class="line">	        hexChars[j * <span class="number">2</span> + <span class="number">1</span>] = HEX_ARRAY[v &amp; <span class="number">0x0F</span>];</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(hexChars);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">克拉拉</span><br><span class="line">4BC9C9</span><br></pre></td></tr></table></figure>

<p>好，那么这个<code>4B C9 C9</code>是个什么东西？<br>我们打开winhex，直接打进去看看：<br><img src="/pictures/chinese-zip-password/8.png"><br>好，复制粘贴到WinRAR：<br><img src="/pictures/chinese-zip-password/9.png"><br><img src="/pictures/chinese-zip-password/10.png">  </p>
<p>好，完工，又是涨奇怪知识的一天。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>难绷的Zip与中文密码</p><p><a href="https://thinkalone.win/chinese-zip-password.html">https://thinkalone.win/chinese-zip-password.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Disappear9</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2024-03-01</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-03-01</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E6%8A%98%E8%85%BE%E9%82%A3%E4%BA%9B%E4%BA%8B/">折腾那些事</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/orangepi-zero-ntp.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">用 Orange Pi Zero 搭建一台 Stratum 1 的 NTP 服务器</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/OrangePiZero-CPU-Benchmark.html"><span class="level-item">OrangePi Zero CPU跑分测试 CPU Benchmark</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><script src="https://giscus.app/client.js" repo="Disappear9/disappear9.github.io" data-repo="Disappear9/disappear9.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkxMTM0MTc3NTc=" data-category-id="DIC_kwDOBsKeHc4CwEsU" data-category="General" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/avatar.png" alt="Disappear9"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Disappear9</p><p class="is-size-6 is-block">Disappear9@D9Lab</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">32</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">8</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/Disappear9"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com/Disappear9_"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#起因"><span class="level-left"><span class="level-item">1</span><span class="level-item">起因</span></span></a></li><li><a class="level is-mobile" href="#试图复现："><span class="level-left"><span class="level-item">2</span><span class="level-item">试图复现：</span></span></a></li><li><a class="level is-mobile" href="#原因分析："><span class="level-left"><span class="level-item">3</span><span class="level-item">原因分析：</span></span></a></li><li><a class="level is-mobile" href="#密码便乘变成什么样了？"><span class="level-left"><span class="level-item">4</span><span class="level-item">密码便乘变成什么样了？</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/logo.png" alt="ThinkAlone" height="28"></a><p class="is-size-7"><span>&copy; 2026 Disappear9</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>